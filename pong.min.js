var Game=Game||{};Game.InputHandler=function(){"use strict";this.keysDown={},this.lastKey=null,this.mouse={},this.mouse={x:0,y:0,clicked:!1,down:!1},this.pressed=!1},Game.InputHandler.prototype.KEY={BACK_SPACE:8,TAB:9,RTN:13,SHIFT:16,CTRL:17,ALT:18,BREAK:19,CAPS:20,ESC:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,NUM_PAD_MULT:106,NUM_PAD_PLUS:107,NUM_PAD_MINUS:109,NUM_PAD_PERIOD:110,NUM_PAD_DIV:111,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUAL_SIGN:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},function(){var e;for(e=0;10>e;e++)Game.InputHandler.prototype.KEY[""+e]=48+e}(),function(){var e;for(e=65;91>e;e++)Game.InputHandler.prototype.KEY[""+String.fromCharCode(e)]=e}(),function(){var e;for(e=96;106>e;e++)Game.InputHandler.prototype.KEY["NUM_PAD_"+(e-96)]=e}(),function(){var e;for(e=112;124>e;e++)Game.InputHandler.prototype.KEY["F"+(e-111)]=e}(),Game.InputHandler.prototype.register=function(){"use strict";var e;e=this,document.addEventListener("keydown",function(t){(t.keyCode!==e.KEY.F5||t.keyCode!==e.KEY.F11)&&(t.preventDefault(),t.stopPropagation()),e.keysDown[t.keyCode]=!0}),document.addEventListener("keyup",function(t){(t.keyCode!==e.KEY.F5||t.keyCode!==e.KEY.F11)&&(t.preventDefault(),t.stopPropagation()),delete e.keysDown[t.keyCode]}),document.addEventListener("mouseover",function(t){e.mouse.x=t.offsetX,e.mouse.y=t.offsetY}),document.addEventListener("mousedown",function(t){e.mouse.down=!0}),document.addEventListener("click",function(t){e.mouse.clicked=!0}),document.addEventListener("mouseup",function(t){e.mouse.down=!1})},Game.InputHandler.prototype.isDown=function(e){"use strict";return this.keysDown[this.KEY[e]]?!0:!1},Game.InputHandler.prototype.update=function(){"use strict";var e,t;e=Object.keys(this.keysDown),t=e.length>0?this.keysDown[e[0]]:null,this.pressed=t!==this.lastKey,this.lastKey=this.keysDown[e[0]]},Game.InputHandler.prototype.reset=function(){"use strict";this.keysDown={},this.lastKey=null,this.mouse={},this.mouse={x:0,y:0,clicked:!1,down:!1},this.pressed=!1};var Game=Game||{};Game.AI=function(e){"use strict";this.baseSpeed=e},Game.AI.prototype.easy=function(e){"use strict";var t;return t=e.ball.y-(e.player.paddle.y+e.player.paddle.height/2),-4>t?t=-this.baseSpeed:t>4&&(t=this.baseSpeed),t},Game.AI.prototype.medium=function(e){"use strict";var t;return e.ball.xSpeed>0&&e.ball.x>e.player.canvasWidth/1.75?(t=e.ball.y-(e.player.paddle.y+e.player.paddle.height/2),-4>t?t=-(this.baseSpeed+.5):t>4&&(t=this.baseSpeed+.5)):t=0,t},Game.AI.prototype.hard=function(e){"use strict";var t;return t};var Game=Game||{};Game.getRandomInt=function(e,t){"use strict";return Math.floor(Math.random()*(t-e))+e},Game.Ball=function(e){"use strict";this.x=e.x||640,this.y=e.y||320,this.radius=e.radius||10,this.xSpeed=e.xSpeed||-4,this.ySpeed=e.ySpeed||Game.getRandomInt(-2,2),this.colour=e.colour||"skyblue"},Game.Ball.prototype.getBBox=function(){"use strict";return{x:this.x-this.radius,y:this.y-this.radius,width:2*this.radius,height:2*this.radius}},Game.Ball.prototype.render=function(e){"use strict";e.beginPath(),e.arc(this.x,this.y,this.radius,2*Math.PI,!1),e.fillStyle=this.colour,e.fill()},Game.Ball.prototype.update=function(){"use strict";this.x+=this.xSpeed,this.y+=this.ySpeed};var Game=Game||{};Game.Paddle=function(e){"use strict";this.x=e.x||20,this.y=e.y||320,this.width=e.width||10,this.height=e.height||50,this.xSpeed=e.xSpeed||0,this.ySpeed=e.ySpeed||0},Game.Paddle.prototype.move=function(e,t,i){"use strict";this.x+=e,this.y+=t,this.xSpeed=e,this.ySpeed=t,this.y<=0?(this.y=0,this.ySpeed=0):this.y+this.height>=i&&(this.y=i-this.height,this.ySpeed=0)},Game.Paddle.prototype.getBBox=function(){"use strict";return{x:this.x,y:this.y,width:this.width,height:this.height}},Game.Paddle.prototype.render=function(e){"use strict";e.fillStyle="#FFFFFF",e.fillRect(this.x,this.y,this.width,this.height)};var Game=Game||{};Game.Player=function(e){"use strict";var t;this.canvasWidth=e.canvasWidth||1280,this.canvasHeight=e.canvasHeight||640,t={x:e.paddle.x||10,y:e.paddle.y||this.canvasHeight/2-e.paddle.height/2,width:e.paddle.width||10,height:e.paddle.height||100},this.paddle=new Game.Paddle(t),this.keys=e.keys||{UP:"I",DOWN:"J"},this.score=0,this.scoreX=e.score.x||this.canvasWidth/2,this.scoreY=e.score.y||this.canvasWidth/10,this.colour=e.colour||"#FFFFFF"},Game.Player.prototype.render=function(e){"use strict";this.paddle.render(e),e.font="bold 80px Helvetica, Verdana, san-serif",e.fillStyle=this.colour,e.fillText(this.score,this.scoreX,this.scoreY)},Game.Player.prototype.update=function(e){"use strict";e.isDown(this.keys.UP)?this.paddle.move(0,-5,this.canvasHeight):e.isDown(this.keys.DOWN)&&this.paddle.move(0,5,this.canvasHeight)};var Game=Game||{};Game.Computer=function(e){"use strict";var t;this.canvasWidth=e.canvasWidth||1280,this.canvasHeight=e.canvasHeight||640,this.difficulty=e.difficulty,this.ai=new Game.AI(e.baseSpeed),t={x:e.paddle.x||this.canvasWidth-10-e.paddle.width,y:e.paddle.y||this.canvasHeight/2-e.paddle.height/2,width:e.paddle.width||10,height:e.paddle.height||100},this.paddle=new Game.Paddle(t),this.score=0,this.scoreX=e.score.x||this.canvasWidth/2,this.scoreY=e.score.y||this.canvasWidth/10,this.colour=e.colour||"#FFFFFF"},Game.Computer.prototype.render=function(e){"use strict";this.paddle.render(e),e.font="bold 80px Helvetica, Verdana, san-serif",e.fillStyle=this.colour,e.fillText(this.score,this.scoreX,this.scoreY)},Game.Computer.prototype.update=function(e){"use strict";var t,i;i={ball:e,player:this},t=this.ai[this.difficulty](i),this.paddle.move(0,t,this.canvasHeight)};var Game=Game||{};Game.Menu=function(e){"use strict";this.title=e.title,this.items=e.items,this.selectedItem=0,this.selectedItemStyle=e.selected,this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.backgroundColour=e.backgroundColour,this.itemSeparator=e.itemSeparator,this.callback=e.callback||function(){}},Game.Menu.prototype.render=function(e){"use strict";var t,i,s;for(s=50,e.fillStyle=this.backgroundColour,e.fillRect(this.x,this.y,this.width,this.height),e.font=this.title.font,e.fillStyle=this.title.colour,i=e.measureText(this.title.text),e.fillText(this.title.text,this.width/2-i.width/2,100),t=0;t<this.items.length;t++)t===this.selectedItem?(e.font=this.selectedItemStyle.font,e.fillStyle=this.selectedItemStyle.colour):(e.font=this.items[t].font,e.fillStyle=this.items[t].colour),i=e.measureText(this.items[t].text),e.fillText(this.items[t].text,this.width/2-i.width/2,200+s),s+=this.itemSeparator},Game.Menu.prototype.update=function(e){"use strict";e.pressed&&(e.isDown("UP")||e.isDown("W")?this.selectedItem>0&&(this.selectedItem-=1):e.isDown("DOWN")||e.isDown("S")?this.selectedItem<this.items.length-1&&(this.selectedItem+=1):e.isDown("RTN")&&this.callback())};var Game=Game||{};Game.MainMenu=function(e,t){"use strict";var i;i={title:{text:"Yet Another Pong Clone",font:"bold 65px Monaco, Courier New, monospace",colour:"#FFFFFF"},items:[{text:"1P",font:"bold 45px Monaco, Courier New, monospace",colour:"#FFFFFF",newScreen:{width:e.width,height:e.height,baseSpeed:e.baseSpeed,callback:e.callback}},{text:"2P",font:"bold 45px Monaco, Courier New, monospace",colour:"#FFFFFF",newScreen:{width:e.width,height:e.height,baseSpeed:5,twoPlayer:!0,players:{}}},{text:"Settings",font:"bold 45px Monaco, Courier New, monospace",colour:"#FFFFFF",newScreen:{}}],selected:{font:"bold 55px Monaco, Courier New, monospace",colour:"#FFCC33"},x:0,y:0,width:e.width||1280,height:e.height||640,backgroundColour:"#000000",itemSeparator:100},Game.Menu.call(this,i),this.callback=function(){0===this.selectedItem?t.switchScreens(new Game.OnePlayerMenu(this.items[this.selectedItem].newScreen,t)):1===this.selectedItem&&t.switchScreens(new Game.Pong(this.items[this.selectedItem].newScreen))}},Game.MainMenu.prototype=Object.create(Game.Menu.prototype),Game.MainMenu.constructor=Game.Menu;var Game=Game||{};Game.OnePlayerMenu=function(e,t){"use strict";var i;i={title:{text:"Select Difficulty",font:"bold 65px Monaco, Courier New, monospace",colour:"#FFFFFF"},items:[{text:"Easy",font:"bold 45px Monaco, Courier New, monospace",colour:"#FFFFFF",newScreen:{width:e.width,height:e.height,baseSpeed:e.baseSpeed,twoPlayer:!1,players:{},difficulty:"easy"}},{text:"Medium",font:"bold 45px Monaco, Courier New, monospace",colour:"#FFFFFF",newScreen:{width:e.width,height:e.height,baseSpeed:e.baseSpeed,twoPlayer:!1,players:{},difficulty:"medium"}}],selected:{font:"bold 55px Monaco, Courier New, monospace",colour:"#FFCC33"},x:0,y:0,width:e.width||1280,height:e.height||640,backgroundColour:"#000000",itemSeparator:100},Game.Menu.call(this,i),this.callback=function(){t.switchScreens(new Game.Pong(this.items[this.selectedItem].newScreen))}},Game.OnePlayerMenu.prototype=Object.create(Game.Menu.prototype),Game.OnePlayerMenu.constructor=Game.Menu;var Game=Game||{};Game.Pong=function(e){"use strict";var t,i,s,a,h;this.width=e.width||1280,this.height=e.height||640,this.twoPlayer=e.twoPlayer,i=e.players.width||10,s=e.players.height||100,a={canvasWidth:this.width,canvasHeight:this.height,paddle:{x:10,y:this.height/2-s/2,width:i,height:s},keys:{UP:"W",DOWN:"S"},score:{x:this.width/2-100,y:80}},this.player1=new Game.Player(a),h={canvasWidth:this.width,canvasHeight:this.height,paddle:{x:this.width-10-i,y:this.height/2-s/2,width:i,height:s},score:{x:this.width/2+50,y:80}},this.twoPlayer?(h.keys={UP:"UP",DOWN:"DOWN"},this.player2=new Game.Player(h)):(h.baseSpeed=e.baseSpeed||5,h.difficulty=e.difficulty||"easy",this.player2=new Game.Computer(h)),t=e.ball||{x:this.width/2,y:this.height/2},this.ball=new Game.Ball(t),this.pause=!1},Game.Pong.prototype.bboxCollision=function(e,t){"use strict";return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y?!0:!1},Game.Pong.prototype.checkCollision=function(){"use strict";(this.ball.x<0||this.ball.x>this.width)&&(this.ball.x<0?(this.player2.score+=1,this.ball.xSpeed=-4):this.ball.x>this.width&&(this.player1.score+=1,this.ball.xSpeed=4),this.ball.x=this.width/2,this.ball.y=this.height/2,this.ball.ySpeed=Game.getRandomInt(-2,2)),this.ball.y-this.ball.radius<=0?(this.ball.y=this.ball.radius,this.ball.ySpeed=-this.ball.ySpeed):this.ball.y+this.ball.radius>=this.height&&(this.ball.y=this.height-this.ball.radius,this.ball.ySpeed=-this.ball.ySpeed),this.bboxCollision(this.player1.paddle.getBBox(),this.ball.getBBox())?(this.ball.xSpeed=-(this.ball.xSpeed-.25),this.ball.x+=this.ball.xSpeed,this.ball.ySpeed+=this.player1.paddle.ySpeed/2):this.bboxCollision(this.player2.paddle.getBBox(),this.ball.getBBox())&&(this.ball.xSpeed=-(this.ball.xSpeed+.25),this.ball.x+=this.ball.xSpeed,this.ball.ySpeed+=this.player2.paddle.ySpeed/2)},Game.Pong.prototype.update=function(e){"use strict";e.pressed&&e.isDown("ESC")&&(this.pause=!this.pause),this.pause||(this.ball.update(),this.player1.update(e),this.twoPlayer?this.player2.update(e):this.player2.update(this.ball),this.checkCollision())},Game.Pong.prototype.render=function(e){"use strict";var t;e.fillStyle="#000000",e.fillRect(0,0,this.width,this.height),e.beginPath(),e.moveTo(this.width/2,0),e.lineTo(this.width/2,this.height),e.lineWidth=3,e.strokeStyle="#FFFFFF",e.stroke(),this.pause&&(e.font="bold 120px Helvetica, Verdana, san-serif",e.fillStyle="#FFDD88",t=e.measureText("Paused").width,e.fillText("Paused",this.width/2-t/2,this.height/2)),this.player1.render(e),this.player2.render(e),this.ball.render(e)};var Game=Game||{};Game.Engine=function(e,t,i,s){"use strict";this.canvas=document.getElementById(e),this.canvas.width=t,this.canvas.height=i,this.FPS=s},Game.Engine.prototype.init=function(){"use strict";this.canvas.focus(),this.ctx=this.canvas.getContext("2d"),this.inputHandler=new Game.InputHandler,this.inputHandler.register()},Game.Engine.prototype.register=function(e){"use strict";this.screen=e},Game.Engine.prototype.update=function(){"use strict";this.inputHandler.update(),this.screen.update(this.inputHandler)},Game.Engine.prototype.render=function(){"use strict";this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.screen.render(this.ctx)},Game.Engine.prototype.stop=function(){"use strict";delete this.screen,this.screen=null},Game.Engine.prototype.switchScreens=function(e){"use strict";this.stop(),this.inputHandler.reset(),this.register(e)},Game.Engine.prototype.step=function(){"use strict";this.update(),this.render()};var Game=Game||{},WIDTH=window.innerWidth,HEIGHT=window.innerHeight,FPS=1e3/30,engine=new Game.Engine("game",WIDTH,HEIGHT,FPS);engine.init(),engine.register(new Game.MainMenu({width:WIDTH,height:HEIGHT},engine));var animate=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,this.FPS)};!function(){function e(){animate(e),engine.step()}e()}();